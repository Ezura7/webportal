<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>Aplikasi Mahasiswa</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet"/>
  <link rel=manifest href=manifest.json>
  <meta name=theme-color content=#1976d2>
  <link rel=apple-touch-icon href=icons/icon-192.png>
  <meta name=apple-mobile-web-app-capable content=yes>
  <link rel="stylesheet" href="styles.css">
  <!-- Firebase App (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <!-- Firebase Realtime Database (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script>
    // Konfigurasi Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyAeC2wlPafry-qaaPF0xvjOtoT7UhYarGg",
      authDomain: "forumchatportal.firebaseapp.com",
      projectId: "forumchatportal",
      storageBucket: "forumchatportal.appspot.com",
      messagingSenderId: "827734259506",
      appId: "1:827734259506:web:5e8a59ff4cc28f32a3892b",
      measurementId: "G-V7SR8JG4TW",
      databaseURL: "https://forumchatportal-default-rtdb.asia-southeast1.firebasedatabase.app/"
    };
    // Inisialisasi Firebase
    firebase.initializeApp(firebaseConfig);
    window.db = firebase.database();
  </script>
</head>
<body>
<div class="container mt-5" id="loginPage" style="max-width: 400px; display: none;">
  <h3 class="mb-3">🔐 Login Mahasiswa</h3>
  <div class="mb-3">
    <label class="form-label" for="username">Username</label>
    <input class="form-control" id="username" placeholder="Masukkan username" type="text"/>
  </div>
  <div class="mb-3">
    <label class="form-label" for="password">Password</label>
    <input class="form-control" id="password" placeholder="Masukkan password" type="password"/>
  </div>
  <button class="btn btn-primary" onclick="doLogin()">Login</button>
  <div class="mb-3 text-center">
    <button class="btn btn-link" onclick="showRegisterModal()">Daftar Akun Baru</button>
  </div>
</div>

<!-- Modal Daftar Akun Baru -->
<div class="modal" tabindex="-1" id="registerModal" style="display:none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Pendaftaran Akun</h5>
        <button type="button" class="btn-close" onclick="hideRegisterModal()"></button>
      </div>
      <div class="modal-body">
        <div class="mb-2">
          <label>Username</label>
          <input type="text" class="form-control" id="regUsername" autocomplete="off">
        </div>
        <div class="mb-2">
          <label>Password</label>
          <input type="password" class="form-control" id="regPassword" autocomplete="off">
        </div>
        <div class="mb-2">
          <label>Nama Lengkap</label>
          <input type="text" class="form-control" id="regNama" autocomplete="off">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="hideRegisterModal()">Batal</button>
        <button class="btn btn-primary" onclick="registerAccount()">Daftar</button>
      </div>
    </div>
  </div>
</div>

<div id="mainApp" style="display:none;">
  <div class="container mt-4" id="mainApp">
    <nav class="nav nav-pills mb-4">
      <button class="nav-link active" onclick="showTab('dashboard')">Dashboard</button>
      <button class="nav-link" onclick="showTab('profil')">Profil</button>
      <button class="nav-link" onclick="showTab('matakuliah')">Mata Kuliah</button>
      <button class="nav-link" onclick="showTab('jadwal')">Jadwal</button>
      <button class="nav-link" onclick="showTab('catatan')">Catatan</button>
      <button class="nav-link" onclick="showTab('nilai')">Nilai</button>
      <button class="nav-link" onclick="showTab('tugas')">Tugas</button>
      <button class="nav-link" onclick="showTab('forumchat')">Forum Chat</button>
      <button class="nav-link" id="verifTabBtn" style="display:none;" onclick="showTab('verifakun')">Verifikasi Akun</button>
    </nav>
    <div class="tab-section tab-active" id="dashboard">
      <h3>📋 Dashboard</h3>
      <textarea id="dashboardInput" placeholder="Catatan umum..."></textarea>
      <button class="btn btn-success mt-2" onclick="simpanText('dashboardInput')">Simpan</button>
    </div>
    <div class="tab-section" id="profil">
      <h3>👤 Profil Mahasiswa</h3>
      <div class="mb-3 text-center">
        <img alt="Foto Profil" class="mb-2" id="fotoPreview" src=""/>
        <input accept="image/*" class="form-control mt-2 d-none" id="fotoInput" onchange="uploadFoto()" type="file"/>
        <button class="btn btn-secondary mt-2" id="editFotoBtn" onclick="editFoto()">Edit Foto Profil</button>
      </div>
      <table class="table table-bordered" id="profilTable">
        <tr><th>Nama</th><td contenteditable="true"></td></tr>
        <tr><th>NIM</th><td contenteditable="true"></td></tr>
        <tr><th>Jurusan</th><td contenteditable="true"></td></tr>
        <tr><th>Semester</th><td contenteditable="true"></td></tr>
      </table>
      <button class="btn btn-success" onclick="simpanProfil()">Simpan</button>
      <button class="btn btn-danger mt-3" onclick="logout()">Logout</button>
    </div>
    <div class="tab-section" id="matakuliah">
      <h3>📚 Mata Kuliah</h3>
      <table class="table table-bordered" id="tabel-matkul">
        <thead><tr><th>Kode</th><th>Nama</th><th>SKS</th><th>Dosen</th><th>Aksi</th></tr></thead>
        <tbody></tbody>
      </table>
      <div class="d-flex gap-2 mb-3">
        <button class="btn btn-success" onclick="simpanTabel('tabel-matkul')">Simpan</button>
        <button class="btn btn-primary" onclick="tambahBarisManual('tabel-matkul')">+ Tambah Baris</button>
      </div>
    </div>
    <div class="tab-section" id="jadwal">
      <h3>🗓️ Jadwal Kuliah</h3>
      <table class="table table-bordered" id="tabel-jadwal">
        <thead><tr><th>Hari</th><th>Jam</th><th>Matkul</th><th>Ruangan</th><th>Aksi</th></tr></thead>
        <tbody></tbody>
      </table>
      <div class="d-flex gap-2 mb-4">
        <button class="btn btn-success" onclick="simpanTabel('tabel-jadwal')">Simpan</button>
        <button class="btn btn-primary" onclick="tambahBarisManual('tabel-jadwal')">+ Tambah Baris</button>
      </div>
      <!-- Kalender Interaktif -->
      <div class="card p-3 mb-4">
        <h5>📆 Kalender Kuliah</h5>
        <div id="calendar"></div>
      </div>
    </div>
    <div class="tab-section" id="catatan">
      <h3>📝 Catatan Kuliah</h3>
      <textarea id="catatanInput" placeholder="Tulis catatanmu di sini..."></textarea>
      <button class="btn btn-primary mt-2" onclick="simpanCatatan()">Simpan Catatan</button>
      <div class="mt-4">
        <h5>📚 Daftar Catatan:</h5>
        <ul class="list-group" id="listCatatan"></ul>
      </div>
    </div>
    <div class="tab-section" id="nilai">
      <h3>📊 Nilai &amp; IPK</h3>
      <table class="table table-bordered" id="tabel-nilai">
        <thead><tr><th>Mata Kuliah</th><th>Nilai</th><th>Bobot</th><th>Aksi</th></tr></thead>
        <tbody></tbody>
      </table>
      <div class="d-flex gap-2 mb-3">
        <button class="btn btn-success" onclick="simpanTabel('tabel-nilai')">Simpan</button>
        <button class="btn btn-primary" onclick="tambahBarisManual('tabel-nilai')">+ Tambah Baris</button>
      </div>
    </div>
    <div class="tab-section" id="tugas">
      <h3>📌 To-Do List / Tugas</h3>
      <table class="table table-bordered" id="tabel-tugas">
        <thead>
          <tr>
            <th>Mata Kuliah</th>
            <th>Deskripsi Tugas</th>
            <th>Deadline</th>
            <th>Status</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="d-flex gap-2 mb-3">
        <button class="btn btn-success" onclick="simpanTabelTugas()">Simpan Tugas</button>
        <button class="btn btn-primary" onclick="tambahBarisManualTugas()">+ Tambah Baris</button>
      </div>
    </div>
    <!-- TAB CHAT ONLINE -->
    <div class="tab-section" id="forumchat">
      <h3>💬 Forum Chat Online</h3>
      <div class="card mb-3">
        <div class="card-body" id="chatBox" style="height:250px;overflow-y:auto"></div>
        <div class="card-footer d-flex">
          <input class="form-control me-2" id="chatInput" placeholder="Tulis pesan...">
          <button class="btn btn-primary" onclick="kirimPesanChat()">Kirim</button>
        </div>
      </div>
    </div>
    <!-- END TAB CHAT ONLINE -->

    <!-- TAB VERIFIKASI AKUN (KHUSUS ADMIN) -->
    <div class="tab-section" id="verifakun" style="display:none;">
      <h3>🛂 Verifikasi Pendaftaran Akun</h3>
      <ul class="list-group" id="pendingUsersList"></ul>
    </div>
    <!-- END TAB VERIFIKASI AKUN -->
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
<script src="app.js"></script>
</body>
</html>
